<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VIP Games</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    /* Hide the main content by default */
    #content { 
      display: none; 
    }

    /* Center the sign-in prompt */
    #signin {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }

    #signin h1 {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div id="signin">
    <h1>Sign In to Access VIP Games</h1>
    <div id="g_id_onload"
         data-client_id="67957050735-n1a9sse7atir2v33ri25ku9r03svd0v8.apps.googleusercontent.com"
         data-auto_prompt="false">
    </div>
    <div class="g_id_signin" data-type="standard"></div>
  </div>

  <div id="content">
    <header class="header">
      <h1>UNBLOCKED GAMES</h1>
      <nav>
        <a href="creds.html">FEEDBACK</a>
        <h3>GAMES</h3>
        <a href="msgs.html">INFO</a>
        <a href="index.html">HOME</a>
      </nav>
    </header>
    <audio id="myAudio" hidden autoplay>
      <source src="background-music-soft-calm-333111.mp3" type="audio/mpeg">
    </audio>
    <a href="time-shooter-3-swat"><img src="timershooter3swat.png" alt="timeshooter3swat"></a>
    <a href="cookieclicker"><img src="CookieClicker.png" alt="CookieCLicker"> </a>
    <a href="bitlife"><img src="bitlife.png" alt="bitlife"> </a>
    <a href="Jacksmith"><img src="Jacksmith.png" alt="jacksmith"> </a>
    <a href="Paperio2"><img src="paperio.png" alt="paper-io"></a>
    <a href="smash-karts"><img src="smashkarts.png" alt="smashkarts"></a>
    <a href="snow-rider3d"><img src="snowrider3d.png" alt="snowrider3d"></a>
    <a href="Bubble-Tanks"><img src="bubbletanks.png" alt="bubbletanks"></a>
    <a href="funny-shooter2"><img src="funnyshooter2.png" alt="funnyshooter2"></a>
    <a href="BasketballStars"><img src="basketballstars.png" alt="basketballstars"></a>
    <a href="BobTheRobber5"><img src="bobtherobber.png" alt="bobtherobber"></a>
    <a href="OvO"><img src="download.png" alt="ovo"></a>
    <a href="BlockBlast"><img src="blockblast.png" alt="blockblast"></a>
    <a href="tetris"><img src="tetris.png" alt="tetris"></a>
    <a href="gunspin"><img src="gunspin.png" alt="gunspin"></a>
    <a href="MaskedForces"><img src="MaskedForces.png" alt="maskedforces"></a>
    <a href="BurritoBison"><img src="BurritoBison.png" alt="burritobison"></a>
    <a href="eaglecraft"><img src="eaglecraft.png" alt="minecraft"></a>
    <a href="papas.html"><img src="papas.png" alt="papas"></a>
    <a href="ducklife.html"><img src="duckliife.png" alt="ducklife"></a>
    <a href="grand-theft-almost"><img src="grandtheftalmost.png" alt="grandtheftalmost.png"></a>
    <a href="1v1lol"><img src="1v1lol.png" alt="1v1lol"></a>
    <p>more coming soon</p>
  </div>

  <script>
    const allowedEmails = [
      "declanradabaugh@worlandhs.com",
      "sagelarson@worlandhs.com",
      "rivergetzfreid@worlandhs.com",
      "damienmitchell@worlandhs.com",
      "jaedonwiniecki@worlandhs.com",
      "davidahlstrom@worlandhs.com",
    ];

    function handleCredentialResponse(response) {
      try {
        const token = response.credential;
        const decodedToken = parseJwt(token); // Decode the JWT to get user email
        console.log("Decoded token:", decodedToken); // Debugging

        if (allowedEmails.includes(decodedToken.email)) {
          document.getElementById("signin").style.display = "none";
          document.getElementById("content").style.display = "block";
        } else {
          console.error("Unauthorized email:", decodedToken.email);
          window.location.href = "deny.html"; // Redirect unauthorized users
        }
      } catch (error) {
        console.error("Error decoding token:", error);
      }
    }

    function parseJwt(token) {
      const base64Url = token.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));
      return JSON.parse(jsonPayload);
    }

    window.onload = function () {
      google.accounts.id.initialize({
        client_id: "67957050735-n1a9sse7atir2v33ri25ku9r03svd0v8.apps.googleusercontent.com",
        callback: handleCredentialResponse
      });
      google.accounts.id.prompt(); // Automatically show the sign-in prompt
    };
  </script>
</body>
</html>
